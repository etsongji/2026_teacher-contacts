<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="ì¶©ì£¼ê³  êµì§ì› ì—°ë½ì²˜">
<meta name="theme-color" content="#3b6ef8">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<title>2026. ì¶©ì£¼ê³  êµì§ì› ì—°ë½ì²˜</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f4f6fb;
    --card: #ffffff;
    --card-hover: #f0f4ff;
    --accent: #3b6ef8;
    --accent2: #6c4fff;
    --text: #1a1d2e;
    --muted: #8891aa;
    --border: #e2e6f0;
    --tag-bg: #eef1fa;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding-bottom: 40px;
  }

  header {
    background: #fff;
    border-bottom: 1px solid var(--border);
    padding: 28px 20px 16px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  }

  .header-title {
    font-size: 22px; font-weight: 700; letter-spacing: -0.5px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text; margin-bottom: 4px;
  }

  .header-sub { font-size: 12px; color: var(--muted); margin-bottom: 14px; }

  .search-bar { position: relative; }

  .search-bar input {
    width: 100%; background: var(--bg); border: 1.5px solid var(--border);
    border-radius: 12px; padding: 12px 16px 12px 42px; color: var(--text);
    font-size: 15px; font-family: 'Noto Sans KR', sans-serif; outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .search-bar input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59,110,248,0.12); }
  .search-bar input::placeholder { color: var(--muted); }

  .search-icon {
    position: absolute; left: 14px; top: 50%; transform: translateY(-50%);
    color: var(--muted); font-size: 16px; pointer-events: none;
  }

  /* â”€â”€ ì¹´í…Œê³ ë¦¬ í•„í„° 2ë‹¨ â”€â”€ */
  .filter-section {
    background: #fff;
    border-bottom: 1px solid var(--border);
    padding-bottom: 10px;
  }

  .filter-row-big {
    display: flex; gap: 8px; overflow-x: auto;
    padding: 12px 16px 0; scrollbar-width: none;
  }
  .filter-row-big::-webkit-scrollbar { display: none; }

  .filter-row-sub {
    display: flex; gap: 6px; overflow-x: auto;
    padding: 8px 16px 0; scrollbar-width: none;
    min-height: 36px;
  }
  .filter-row-sub::-webkit-scrollbar { display: none; }

  .filter-btn-big {
    background: var(--tag-bg); border: 1.5px solid var(--border);
    border-radius: 20px; padding: 7px 16px; color: var(--muted);
    font-size: 14px; font-family: 'Noto Sans KR', sans-serif;
    white-space: nowrap; cursor: pointer; transition: all 0.2s;
    flex-shrink: 0; font-weight: 600;
  }

  .filter-btn-big.active {
    background: var(--accent); border-color: var(--accent); color: #fff;
  }

  .filter-btn-sub {
    background: #fff; border: 1.5px solid var(--border);
    border-radius: 16px; padding: 5px 12px; color: var(--muted);
    font-size: 12px; font-family: 'Noto Sans KR', sans-serif;
    white-space: nowrap; cursor: pointer; transition: all 0.2s;
    flex-shrink: 0; font-weight: 500;
  }

  .filter-btn-sub.active {
    background: #e8eeff; border-color: var(--accent); color: var(--accent); font-weight: 700;
  }

  .filter-btn-sub:hover { border-color: var(--accent); color: var(--accent); }

  .status-bar {
    display: flex; justify-content: flex-end;
    padding: 10px 20px 2px; font-size: 11px;
    font-family: 'DM Mono', monospace; color: var(--muted);
  }

  .contacts-list { padding: 4px 16px 0; }

  .section-label {
    font-size: 11px; font-weight: 700; letter-spacing: 1.5px;
    color: var(--muted); text-transform: uppercase; padding: 14px 4px 6px;
  }

  .contact-card {
    background: var(--card); border: 1.5px solid var(--border);
    border-radius: 16px; padding: 14px 16px;
    display: flex; align-items: center; gap: 14px;
    cursor: pointer; transition: all 0.2s; color: inherit;
    margin-bottom: 8px; animation: fadeIn 0.3s ease forwards; opacity: 0;
    box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  }

  .contact-card:hover, .contact-card:active {
    background: var(--card-hover); border-color: var(--accent);
    transform: translateY(-1px); box-shadow: 0 4px 20px rgba(59,110,248,0.12);
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .avatar {
    width: 46px; height: 46px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 17px; font-weight: 700; flex-shrink: 0; color: #fff;
  }

  .contact-info { flex: 1; min-width: 0; }

  .contact-name { font-size: 15px; font-weight: 600; margin-bottom: 3px; letter-spacing: -0.3px; color: var(--text); }
  .contact-subject { font-size: 12px; color: var(--muted); margin-bottom: 3px; }
  .contact-phone { display: none; }

  .card-arrow {
    width: 28px; height: 28px; border-radius: 50%;
    background: var(--tag-bg); display: flex; align-items: center;
    justify-content: center; flex-shrink: 0; color: var(--muted);
    font-size: 13px; transition: all 0.2s;
  }

  .contact-card:hover .card-arrow { background: var(--accent); color: #fff; }

  .empty-state { text-align: center; padding: 60px 20px; color: var(--muted); }
  .empty-state .emoji { font-size: 36px; margin-bottom: 10px; }
  .empty-state p { font-size: 14px; }

  /* â”€â”€ ì•¡ì…˜ ì‹œíŠ¸ â”€â”€ */
  .sheet-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.35);
    z-index: 300; display: flex; align-items: flex-end;
    backdrop-filter: blur(3px); animation: fadeBg 0.2s ease;
  }

  @keyframes fadeBg { from { opacity:0; } to { opacity:1; } }

  .sheet {
    background: #fff; border-radius: 24px 24px 0 0;
    width: 100%; padding: 12px 16px 44px;
    animation: slideUp 0.25s cubic-bezier(.32,1,.6,1);
    box-shadow: 0 -4px 30px rgba(0,0,0,0.1);
  }

  @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

  .sheet-handle { width: 36px; height: 4px; background: #e2e6f0; border-radius: 2px; margin: 0 auto 18px; }

  .sheet-profile {
    display: flex; align-items: center; gap: 14px;
    padding: 0 4px 18px; border-bottom: 1px solid #f0f2f8; margin-bottom: 14px;
  }

  .sheet-avatar {
    width: 54px; height: 54px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: 700; color: #fff; flex-shrink: 0;
  }

  .sheet-name { font-size: 19px; font-weight: 700; letter-spacing: -0.4px; color: #1a1d2e; margin-bottom: 3px; }
  .sheet-subject { font-size: 13px; color: #8891aa; margin-bottom: 4px; }
  .sheet-phone { font-family: 'DM Mono', monospace; font-size: 14px; color: #3b6ef8; font-weight: 500; }

  .sheet-actions { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }

  .sheet-btn {
    display: flex; align-items: center; gap: 16px;
    width: 100%; background: #f4f6fb; border: none;
    border-radius: 16px; padding: 15px 18px;
    font-size: 15px; font-family: 'Noto Sans KR', sans-serif;
    font-weight: 600; color: #1a1d2e; cursor: pointer;
    transition: background 0.15s; text-align: left; text-decoration: none;
  }

  .sheet-btn:active, .sheet-btn:hover { background: #e8edf8; }

  .btn-icon {
    width: 42px; height: 42px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 19px; flex-shrink: 0;
  }

  .btn-call .btn-icon { background: linear-gradient(135deg,#3b6ef8,#6c4fff); }
  .btn-save .btn-icon { background: linear-gradient(135deg,#1dd1a1,#10ac84); }

  .btn-text { flex: 1; }
  .btn-desc { font-size: 12px; font-weight: 400; color: #8891aa; margin-top: 2px; }

  .sheet-cancel {
    display: block; width: 100%; background: none;
    border: 1.5px solid #e2e6f0; border-radius: 14px; padding: 14px;
    font-size: 15px; font-family: 'Noto Sans KR', sans-serif; font-weight: 600;
    color: #8891aa; cursor: pointer; margin-top: 4px; transition: all 0.15s;
  }

  .sheet-cancel:hover { background: #f4f6fb; }

  /* â”€â”€ ì €ì¥ ì•ˆë‚´ íŒì—… â”€â”€ */
  .save-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.5);
    z-index: 400; display: flex; align-items: center; justify-content: center;
    padding: 24px; backdrop-filter: blur(4px); animation: fadeBg 0.2s ease;
  }

  .save-popup {
    background: #fff; border-radius: 24px; padding: 28px 24px;
    width: 100%; max-width: 360px;
    animation: popIn 0.25s cubic-bezier(.32,1,.6,1);
    box-shadow: 0 8px 40px rgba(0,0,0,0.18);
  }

  @keyframes popIn {
    from { transform: scale(0.85); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  .save-title { font-size: 17px; font-weight: 700; margin-bottom: 6px; color: #1a1d2e; }
  .save-name { font-size: 13px; color: #8891aa; margin-bottom: 16px; }

  .save-phone-box {
    background: #eef1fa; border: 2px dashed #3b6ef8;
    border-radius: 14px; padding: 16px 18px;
    display: flex; align-items: center; justify-content: space-between;
    cursor: pointer; margin-bottom: 20px; transition: background 0.15s;
  }

  .save-phone-box:active { background: #dde4ff; }

  .save-phone-box span:first-child {
    font-family: 'DM Mono', monospace; font-size: 20px;
    font-weight: 700; color: #3b6ef8; letter-spacing: 1px;
  }

  .copy-badge {
    font-size: 11px !important; font-weight: 600 !important;
    background: #3b6ef8; color: #fff !important;
    padding: 4px 10px; border-radius: 20px; letter-spacing: 0 !important;
    font-family: 'Noto Sans KR', sans-serif !important;
  }

  .copy-badge.copied { background: #1dd1a1; }

  .save-steps { display: flex; flex-direction: column; gap: 10px; margin-bottom: 22px; }

  .save-step {
    display: flex; align-items: center; gap: 12px;
    font-size: 13px; color: #4a5270;
  }

  .step-num {
    width: 24px; height: 24px; border-radius: 50%;
    background: linear-gradient(135deg,#3b6ef8,#6c4fff);
    color: #fff; font-size: 12px; font-weight: 700;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
  }

  .save-close {
    width: 100%; background: linear-gradient(135deg,#3b6ef8,#6c4fff);
    border: none; border-radius: 14px; padding: 14px;
    font-size: 15px; font-family: 'Noto Sans KR', sans-serif;
    font-weight: 700; color: #fff; cursor: pointer;
  }
</style>
</head>
<body>

<header>
  <div class="header-title">ğŸ“‹ 2026. ì¶©ì£¼ê³  êµì§ì› ì—°ë½ì²˜</div>
  <div class="header-sub">ì´ë¦„ì„ íƒ­í•˜ë©´ ì „í™”Â·ì €ì¥ ì„ íƒ</div>
  <div class="search-bar">
    <span class="search-icon">ğŸ”</span>
    <input type="text" id="searchInput" placeholder="ì´ë¦„ ë˜ëŠ” êµê³¼ë¡œ ê²€ìƒ‰..." oninput="onSearch()">
  </div>
</header>

<div class="filter-section">
  <div class="filter-row-big" id="filterBig"></div>
  <div class="filter-row-sub" id="filterSub"></div>
</div>

<div class="status-bar"><span id="countBadge"></span></div>
<div class="contacts-list" id="contactsList"></div>

<!-- ì•¡ì…˜ ì‹œíŠ¸ -->
<div class="sheet-overlay" id="sheetOverlay" style="display:none" onclick="if(event.target===this)closeSheet()">
  <div class="sheet">
    <div class="sheet-handle"></div>
    <div class="sheet-profile">
      <div class="sheet-avatar" id="sheetAvatar"></div>
      <div>
        <div class="sheet-name" id="sheetName"></div>
        <div class="sheet-subject" id="sheetSubject"></div>
        <div class="sheet-phone" id="sheetPhone"></div>
      </div>
    </div>
    <div class="sheet-actions">
      <a class="sheet-btn btn-call" id="btnCall" href="#">
        <div class="btn-icon">ğŸ“</div>
        <div class="btn-text">ì „í™” ê±¸ê¸°<div class="btn-desc">ë°”ë¡œ í†µí™” ì—°ê²°</div></div>
      </a>
      <button class="sheet-btn btn-save" onclick="saveContact()">
        <div class="btn-icon">ğŸ’¾</div>
        <div class="btn-text">ì—°ë½ì²˜ ì €ì¥<div class="btn-desc">ë²ˆí˜¸ ë³µì‚¬ í›„ ì €ì¥ ì•ˆë‚´</div></div>
      </button>
    </div>
    <button class="sheet-cancel" onclick="closeSheet()">ì·¨ì†Œ</button>
  </div>
</div>

<!-- ì €ì¥ ì•ˆë‚´ íŒì—… -->
<div class="save-overlay" id="saveOverlay" style="display:none" onclick="if(event.target===this)closeSave()">
  <div class="save-popup">
    <div class="save-title">ğŸ“± ì—°ë½ì²˜ ì €ì¥ ë°©ë²•</div>
    <div class="save-name" id="saveName"></div>
    <div class="save-phone-box" id="savePhoneBox" onclick="copyPhone()">
      <span id="savePhoneNum"></span>
      <span class="copy-badge" id="copyBadge">íƒ­í•˜ì—¬ ë³µì‚¬</span>
    </div>
    <div class="save-steps">
      <div class="save-step"><span class="step-num">1</span><span>ìœ„ ë²ˆí˜¸ë¥¼ íƒ­í•´ì„œ ë³µì‚¬í•˜ì„¸ìš”</span></div>
      <div class="save-step"><span class="step-num">2</span><span>ì „í™” ì•± â†’ í‚¤íŒ¨ë“œ â†’ ë²ˆí˜¸ ë¶™ì—¬ë„£ê¸°</span></div>
      <div class="save-step"><span class="step-num">3</span><span>ìƒˆ ì—°ë½ì²˜ë¡œ ì €ì¥</span></div>
    </div>
    <button class="save-close" onclick="closeSave()">í™•ì¸</button>
  </div>
</div>

<script>
const CONTACTS = [
  {name:"ì´ê·œí›ˆ", subject:"êµì¥", phone:"010-5247-4167"},
  {name:"ì„ì„±ê·œ", subject:"êµê°", phone:"010-9460-9640"},
  {name:"ê¹€ë¬¸ìš©", subject:"í–‰ì •ë¶€ì¥", phone:"010-6750-1084"},
  {name:"ê¹€ë¯¸ê²½", subject:"í–‰ì •ì‹¤ì¥", phone:"010-2014-9895"},
  {name:"ë°•ë¯¸ì„ ", subject:"í–‰ì •ì‹¤ë¬´ì‚¬", phone:"010-2074-8736"},
  {name:"ë°•ì†Œí˜„", subject:"ì£¼ë¬´ê´€", phone:"010-4471-4871"},
  {name:"ë°•ì§€ì›…", subject:"ì£¼ë¬´ê´€", phone:"010-2824-1940"},
  {name:"ì´ì¶©ê·œ", subject:"ì£¼ë¬´ê´€", phone:"010-3410-6649"},
  {name:"ì¡°ì€ì£¼", subject:"êµë¬´ì‹¤ë¬´ì‚¬", phone:"010-2649-6158"},
  {name:"ê¹€ë¯¼ì •", subject:"êµë¬´ì‹¤ë¬´ì‚¬", phone:"010-4709-1429"},
  {name:"ê°•ì •ìˆ™", subject:"ìˆ˜í•™", phone:"010-6463-1654"},
  {name:"ê¶Œì˜¤ë¯¸", subject:"ì¼ë°˜ì‚¬íšŒ", phone:"010-5278-0603"},
  {name:"ê¹€ê¸°ì¤€", subject:"ìˆ˜í•™", phone:"010-8844-5897"},
  {name:"ê¹€ìƒí›ˆ", subject:"ì²´ìœ¡", phone:"010-3711-8074"},
  {name:"ê¹€ì„ ë¯¸", subject:"ì‚¬ì„œ", phone:"010-8719-7365"},
  {name:"ê¹€ìŠ¹í˜", subject:"ë¬¼ë¦¬", phone:"010-3333-6899"},
  {name:"ê¹€ì€ì§€", subject:"ì¼ë°˜ì‚¬íšŒ", phone:"010-7599-6438"},
  {name:"ê¹€í˜„ìš°", subject:"êµ­ì–´", phone:"010-2461-3276"},
  {name:"ê¹€í˜„ì •", subject:"ìƒëª…ê³¼í•™", phone:"010-9406-4085"},
  {name:"ê¹€í˜„ì§„", subject:"ì—­ì‚¬", phone:"010-5560-4904"},
  {name:"ê¹€í˜œë¯¼", subject:"ë³´ê±´", phone:"010-8561-2560"},
  {name:"ê¹€í˜œì¸", subject:"ì˜ì–´", phone:"010-2392-1461"},
  {name:"ê¹€í˜¸ì„±", subject:"ì§„ë¡œ", phone:"010-8842-4979"},
  {name:"ê¹€í¬ìˆ˜", subject:"ìˆ˜í•™", phone:"010-7670-5037"},
  {name:"ë‚˜ìœ¤ì£¼", subject:"ìœ¤ë¦¬", phone:"010-9857-6860"},
  {name:"ë°•ë™í™˜", subject:"ì§€êµ¬ê³¼í•™", phone:"010-3289-5385"},
  {name:"ë°•ìµì„ ", subject:"ìˆ˜í•™", phone:"010-4465-7238"},
  {name:"ë°•ì§€í›ˆ", subject:"ì •ë³´", phone:"010-8887-5792"},
  {name:"ë³€ì§€í˜•", subject:"ì§€êµ¬ê³¼í•™", phone:"010-2430-0304"},
  {name:"ì„œì˜ˆë¦¼", subject:"ìŒì•…", phone:"010-2900-0030"},
  {name:"ì†¡ì§€ì–¸", subject:"ì˜ì–´", phone:"010-5192-2897"},
  {name:"ì‹ ë™í˜¸", subject:"êµ­ì–´", phone:"010-5566-1763"},
  {name:"ì‹ í˜„ì¤€", subject:"ì§€ë¦¬", phone:"010-4001-7149"},
  {name:"ì•ˆê·¼í˜¸", subject:"ì¼ë³¸ì–´", phone:"010-5596-0085"},
  {name:"ì•ˆì§„í˜•", subject:"ë¬¼ë¦¬", phone:"010-3463-5426"},
  {name:"ìš°ë§Œì‹", subject:"ì—­ì‚¬", phone:"010-3679-3057"},
  {name:"ìœ„íƒœìš©", subject:"ì²´ìœ¡", phone:"010-7372-8897"},
  {name:"ìœ ì§„í¬", subject:"ì˜ì–´", phone:"010-9737-5422"},
  {name:"ìœ¡ê°ìš°", subject:"ìˆ˜í•™", phone:"010-3311-1005"},
  {name:"ìœ¤ì¤€í˜¸", subject:"ìˆ˜í•™", phone:"010-9218-5719"},
  {name:"ì´ë¯¼ì •", subject:"ìˆ˜í•™", phone:"010-2996-5573"},
  {name:"ì´ë³‘ëª¨", subject:"ìƒëª…ê³¼í•™", phone:"010-3474-2707"},
  {name:"ì´ìƒ˜ë‚˜", subject:"ì˜ì–‘", phone:"010-4780-7276"},
  {name:"ì´ìŠ¬ì´", subject:"ì˜ì–´", phone:"010-5761-8667"},
  {name:"ì´ì¤€í˜„", subject:"êµ­ì–´", phone:"010-3401-1680"},
  {name:"ì´í•œë³„", subject:"êµ­ì–´", phone:"010-2295-4256"},
  {name:"ì „ì€ì˜", subject:"ì˜ì–´", phone:"010-4394-0423"},
  {name:"ì „íš¨ë‚˜", subject:"ì§€ë¦¬", phone:"010-8720-2976"},
  {name:"ì „í¬ì£¼", subject:"í”„ë‘ìŠ¤ì–´", phone:"010-2331-0562"},
  {name:"ì •ë¯¸ì •", subject:"ì˜ì–´", phone:"010-8641-3392"},
  {name:"ì •í˜œì •", subject:"ë¯¸ìˆ ", phone:"010-4536-2931"},
  {name:"ì¡°ë‚¨í˜", subject:"ì—­ì‚¬", phone:"010-2644-9827"},
  {name:"ìµœì„œì€", subject:"êµ­ì–´", phone:"010-5487-0639"},
  {name:"í‘œë¯¼í¬", subject:"í™”í•™", phone:"010-9602-3361"},
  {name:"í•œê±´í¬", subject:"í™”í•™", phone:"010-9270-0519"},
  {name:"í™ì„±ê±´", subject:"ì²´ìœ¡", phone:"010-2694-2248"},
  {name:"í™©ì¸í™˜", subject:"êµ­ì–´", phone:"010-2744-9027"},
  {name:"í™©í¬ì •", subject:"êµ­ì–´", phone:"010-9218-0326"},
];

// â”€â”€ ëŒ€ë¶„ë¥˜ ê·¸ë£¹ ì •ì˜ â”€â”€
const GROUPS = [
  { label: 'ì „ì²´',   subs: [] },
  { label: 'ê´€ë¦¬ì', subs: ['êµì¥','êµê°'] },
  { label: 'í–‰ì •ì‹¤', subs: ['í–‰ì •ë¶€ì¥','í–‰ì •ì‹¤ì¥','í–‰ì •ì‹¤ë¬´ì‚¬','ì£¼ë¬´ê´€','êµë¬´ì‹¤ë¬´ì‚¬'] },
  { label: 'êµ­ì–´',   subs: ['êµ­ì–´'] },
  { label: 'ì˜ì–´',   subs: ['ì˜ì–´'] },
  { label: 'ìˆ˜í•™',   subs: ['ìˆ˜í•™'] },
  { label: 'ê³¼í•™',   subs: ['ë¬¼ë¦¬','í™”í•™','ìƒëª…ê³¼í•™','ì§€êµ¬ê³¼í•™'] },
  { label: 'ì‚¬íšŒ',   subs: ['ì¼ë°˜ì‚¬íšŒ','ì—­ì‚¬','ì§€ë¦¬','ìœ¤ë¦¬'] },
  { label: 'ì˜ˆì²´ëŠ¥', subs: ['ì²´ìœ¡','ìŒì•…','ë¯¸ìˆ '] },
  { label: 'ì™¸êµ­ì–´', subs: ['ì¼ë³¸ì–´','í”„ë‘ìŠ¤ì–´'] },
  { label: 'ê¸°íƒ€',   subs: ['ì •ë³´','ì§„ë¡œ','ë³´ê±´','ì˜ì–‘','ì‚¬ì„œ'] },
];

const SUBJECT_COLORS = {
  "êµì¥":"linear-gradient(135deg,#2d3436,#636e72)",
  "êµê°":"linear-gradient(135deg,#485460,#808e9b)",
  "í–‰ì •ë¶€ì¥":"linear-gradient(135deg,#e17055,#d35400)",
  "í–‰ì •ì‹¤ì¥":"linear-gradient(135deg,#e67e22,#f39c12)",
  "í–‰ì •ì‹¤ë¬´ì‚¬":"linear-gradient(135deg,#f9ca24,#f0932b)",
  "ì£¼ë¬´ê´€":"linear-gradient(135deg,#badc58,#6ab04c)",
  "êµë¬´ì‹¤ë¬´ì‚¬":"linear-gradient(135deg,#22a6b3,#30336b)",
  "ìˆ˜í•™":"linear-gradient(135deg,#4f7cff,#7c4fff)",
  "êµ­ì–´":"linear-gradient(135deg,#ff6b6b,#ee5a24)",
  "ì˜ì–´":"linear-gradient(135deg,#1dd1a1,#10ac84)",
  "ì—­ì‚¬":"linear-gradient(135deg,#ff9f43,#ee5a24)",
  "ì§€ë¦¬":"linear-gradient(135deg,#f9a825,#feca57)",
  "ì¼ë°˜ì‚¬íšŒ":"linear-gradient(135deg,#ff6b81,#c0392b)",
  "ìœ¤ë¦¬":"linear-gradient(135deg,#a29bfe,#6c5ce7)",
  "ë¬¼ë¦¬":"linear-gradient(135deg,#74b9ff,#0984e3)",
  "í™”í•™":"linear-gradient(135deg,#fd79a8,#e84393)",
  "ìƒëª…ê³¼í•™":"linear-gradient(135deg,#55efc4,#00b894)",
  "ì§€êµ¬ê³¼í•™":"linear-gradient(135deg,#fdcb6e,#e17055)",
  "ì²´ìœ¡":"linear-gradient(135deg,#d63031,#e17055)",
  "ìŒì•…":"linear-gradient(135deg,#a29bfe,#fd79a8)",
  "ë¯¸ìˆ ":"linear-gradient(135deg,#fd79a8,#fdcb6e)",
  "ì •ë³´":"linear-gradient(135deg,#00cec9,#0984e3)",
  "ì§„ë¡œ":"linear-gradient(135deg,#6c5ce7,#a29bfe)",
  "ë³´ê±´":"linear-gradient(135deg,#ff7675,#d63031)",
  "ì˜ì–‘":"linear-gradient(135deg,#55efc4,#fdcb6e)",
  "ì‚¬ì„œ":"linear-gradient(135deg,#b2bec3,#636e72)",
  "ì¼ë³¸ì–´":"linear-gradient(135deg,#e17055,#d63031)",
  "í”„ë‘ìŠ¤ì–´":"linear-gradient(135deg,#0984e3,#74b9ff)",
};

// ì •ë ¬ ìš°ì„ ìˆœìœ„ (ê´€ë¦¬ìÂ·í–‰ì •ì‹¤ ë¨¼ì €)
const SORT_PRIORITY = ['êµì¥','êµê°','í–‰ì •ë¶€ì¥','í–‰ì •ì‹¤ì¥','í–‰ì •ì‹¤ë¬´ì‚¬','ì£¼ë¬´ê´€','êµë¬´ì‹¤ë¬´ì‚¬'];

let currentBig = 'ì „ì²´';
let currentSub = null; // nullì´ë©´ ëŒ€ë¶„ë¥˜ ì „ì²´
let currentContact = null;

// â”€â”€ í•„í„° ë Œë” â”€â”€
function buildFilters() {
  // ëŒ€ë¶„ë¥˜ ë²„íŠ¼
  document.getElementById('filterBig').innerHTML = GROUPS.map(g =>
    `<button class="filter-btn-big ${g.label===currentBig?'active':''}" onclick="setBig('${g.label}')">${g.label}</button>`
  ).join('');

  // ì†Œë¶„ë¥˜ ë²„íŠ¼ (ì „ì²´ ì„ íƒì‹œ ìˆ¨ê¹€, ì†Œë¶„ë¥˜ 1ê°œë©´ ìˆ¨ê¹€)
  const group = GROUPS.find(g => g.label === currentBig);
  const subs = group ? group.subs.filter(s => CONTACTS.some(c => c.subject === s)) : [];

  if (subs.length > 1) {
    document.getElementById('filterSub').innerHTML =
      `<button class="filter-btn-sub ${currentSub===null?'active':''}" onclick="setSub(null)">ì „ì²´</button>` +
      subs.map(s =>
        `<button class="filter-btn-sub ${currentSub===s?'active':''}" onclick="setSub('${s}')">${s}</button>`
      ).join('');
  } else {
    document.getElementById('filterSub').innerHTML = '';
  }
}

function setBig(label) {
  currentBig = label;
  currentSub = null;
  buildFilters();
  filterContacts();
}

function setSub(sub) {
  currentSub = sub;
  buildFilters();
  filterContacts();
}

function onSearch() { filterContacts(); }

// â”€â”€ í•„í„° & ë Œë” â”€â”€
function filterContacts() {
  const query = document.getElementById('searchInput').value.toLowerCase().trim();
  const group = GROUPS.find(g => g.label === currentBig);

  let filtered = CONTACTS;

  if (currentBig !== 'ì „ì²´' && group) {
    if (currentSub) {
      filtered = filtered.filter(c => c.subject === currentSub);
    } else {
      filtered = filtered.filter(c => group.subs.includes(c.subject));
    }
  }

  if (query) {
    filtered = filtered.filter(c =>
      c.name.includes(query) || (c.subject||'').includes(query)
    );
  }

  renderContacts(filtered);
}

function renderContacts(contacts) {
  document.getElementById('countBadge').textContent = `ì´ ${contacts.length}ëª…`;
  const list = document.getElementById('contactsList');

  if (contacts.length === 0) {
    list.innerHTML = `<div class="empty-state"><div class="emoji">ğŸ”</div><p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p></div>`;
    return;
  }

  const sorted = [...contacts].sort((a, b) => {
    const ai = SORT_PRIORITY.indexOf(a.subject);
    const bi = SORT_PRIORITY.indexOf(b.subject);
    if (ai !== -1 || bi !== -1) return (ai === -1 ? 99 : ai) - (bi === -1 ? 99 : bi);
    return a.name.localeCompare(b.name, 'ko');
  });

  let html = '';
  let prevInitial = '';

  sorted.forEach((c, i) => {
    const initial = c.name[0];
    if (initial !== prevInitial) {
      html += `<div class="section-label">${initial}</div>`;
      prevInitial = initial;
    }
    const color = SUBJECT_COLORS[c.subject] || "linear-gradient(135deg,#4f7cff,#7c4fff)";
    html += `
      <div class="contact-card" onclick="openSheet(${JSON.stringify(c).replace(/"/g,'&quot;')})" style="animation-delay:${Math.min(i,25)*0.03}s">
        <div class="avatar" style="background:${color}">${c.name[0]}</div>
        <div class="contact-info">
          <div class="contact-name">${c.name}</div>
          ${c.subject?`<div class="contact-subject">${c.subject}</div>`:''}
          <div class="contact-phone">${c.phone}</div>
        </div>
        <div class="card-arrow">â€º</div>
      </div>`;
  });

  list.innerHTML = html;
}

// â”€â”€ ì•¡ì…˜ ì‹œíŠ¸ â”€â”€
function openSheet(c) {
  currentContact = c;
  const color = SUBJECT_COLORS[c.subject] || "linear-gradient(135deg,#4f7cff,#7c4fff)";
  document.getElementById('sheetAvatar').textContent = c.name[0];
  document.getElementById('sheetAvatar').style.background = color;
  document.getElementById('sheetName').textContent = c.name;
  document.getElementById('sheetSubject').textContent = c.subject;
  document.getElementById('sheetPhone').textContent = c.phone;
  document.getElementById('btnCall').href = 'tel:' + c.phone.replace(/[^0-9]/g,'');
  document.getElementById('sheetOverlay').style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

function closeSheet() {
  document.getElementById('sheetOverlay').style.display = 'none';
  document.body.style.overflow = '';
  currentContact = null;
}

function isPWA() {
  return window.navigator.standalone === true ||
         window.matchMedia('(display-mode: standalone)').matches;
}

function saveContact() {
  if (!currentContact) return;
  const c = currentContact;

  if (isPWA()) {
    // â”€â”€ ì•± ëª¨ë“œ: .vcf íŒŒì¼ë¡œ ë°”ë¡œ ì €ì¥ â”€â”€
    const vcard = [
      "BEGIN:VCARD", "VERSION:3.0",
      "FN:" + c.name,
      "N:" + c.name[0] + ";" + c.name.slice(1) + ";;;",
      "TEL;TYPE=CELL:" + c.phone,
      "TITLE:" + c.subject,
      "ORG:ì¶©ì£¼ê³ ",
      "END:VCARD"
    ].join("\r\n");

    const blob = new Blob([vcard], { type: "text/vcard" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = c.name + ".vcf";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(() => URL.revokeObjectURL(url), 1000);
    closeSheet();
  } else {
    // â”€â”€ ì›¹ ëª¨ë“œ: ë²ˆí˜¸ ë³µì‚¬ + ì•ˆë‚´ íŒì—… â”€â”€
    document.getElementById('saveName').textContent = c.name + ' Â· ' + c.subject;
    document.getElementById('savePhoneNum').textContent = c.phone;
    document.getElementById('copyBadge').textContent = 'íƒ­í•˜ì—¬ ë³µì‚¬';
    document.getElementById('copyBadge').className = 'copy-badge';
    document.getElementById('saveOverlay').style.display = 'flex';
    closeSheet();
    copyPhone();
  }
}

function copyPhone() {
  const phone = document.getElementById('savePhoneNum').textContent;
  const badge = document.getElementById('copyBadge');
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(phone).then(() => {
      badge.textContent = 'âœ“ ë³µì‚¬ë¨!';
      badge.className = 'copy-badge copied';
    });
  } else {
    // fallback
    const ta = document.createElement('textarea');
    ta.value = phone;
    ta.style.position = 'fixed'; ta.style.opacity = '0';
    document.body.appendChild(ta); ta.focus(); ta.select();
    try { document.execCommand('copy'); badge.textContent = 'âœ“ ë³µì‚¬ë¨!'; badge.className = 'copy-badge copied'; } catch(e) {}
    document.body.removeChild(ta);
  }
}

function closeSave() {
  document.getElementById('saveOverlay').style.display = 'none';
}

buildFilters();
filterContacts();
</script>
</body>
</html>
